# Виртуальная клавиатура (Лабораторная работа 6)

## Описание

Реализация виртуальной клавиатуры с поддержкой паттернов Command и Memento на языке C++.

## Функциональность

- ✅ Добавление/изменение ассоциации клавиши с командой
- ✅ Откат последней выполненной команды (undo)
- ✅ Возврат последней выполненной команды после отката (redo)
- ✅ Сохранение привязок клавиш в JSON файл
- ✅ Восстановление привязок при перезапуске программы

## Реализованные команды

1. **PrintCommand** - печать символа
2. **VolumeUpCommand** - увеличение громкости
3. **VolumeDownCommand** - уменьшение громкости
4. **MediaPlayerCommand** - запуск медиа-плеера

## Структура проекта

```
├── Command.h              # Базовый абстрактный класс Command
├── Keyboard.h/.cpp        # Класс виртуальной клавиатуры
├── Commands.h/.cpp        # Конкретные реализации команд
├── CommandFactory.h/.cpp  # Фабрика для создания команд
├── KeyboardStateSaver.h/.cpp # Сохранение/загрузка состояния (Memento)
├── main.cpp               # Основная функция с демонстрацией
├── CMakeLists.txt         # Файл конфигурации CMake
├── Makefile               # Файл для компиляции (альтернативный)
├── .gitignore             # Игнорируемые файлы для Git
└── README.md              # Этот файл
```

## Компиляция и запуск

### Требования
- Компилятор C++ с поддержкой C++17 (g++, clang++, MSVC)
- CMake 3.10 или выше
- Make (опционально, для Makefile)

### Сборка с помощью CMake (рекомендуется)

```bash
# Клонирование репозитория
git clone <repository-url>
cd sixthLab

# Создание директории для сборки
mkdir build
cd build

# Конфигурация проекта
cmake ..

# Сборка проекта
cmake --build .

# Запуск программы
./bin/virtual_keyboard
# или на Windows:
# bin\virtual_keyboard.exe
```

### Альтернативные способы сборки

#### С помощью Makefile
```bash
# Сборка
make

# Запуск
make run

# Очистка
make clean
```

#### Ручная компиляция
```bash
g++ -std=c++17 -Wall -Wextra -O2 *.cpp -o virtual_keyboard
./virtual_keyboard
```

### Дополнительные команды CMake

```bash
# Отладочная сборка
cmake -DCMAKE_BUILD_TYPE=Debug ..
cmake --build .

# Релизная сборка
cmake -DCMAKE_BUILD_TYPE=Release ..
cmake --build .

# Запуск через CMake
cmake --build . --target run

# Очистка выходных файлов
cmake --build . --target clean-output

# Установка программы
cmake --build . --target install

# Создание пакета для распространения
cmake --build . --target package

# Показать справку
cmake --build . --target help
```

## Пример работы

Программа выполняет следующую последовательность команд:
1. Печатает символы 'a', 'b', 'c'
2. Выполняет undo дважды (удаляет 'c' и 'b')
3. Выполняет redo (возвращает 'b')
4. Увеличивает громкость на 20%
5. Уменьшает громкость на 20%
6. Запускает медиа-плеер
7. Печатает символ 'd'
8. Выполняет undo дважды

Результат выводится как в консоль, так и в файл `output.txt`.

## Используемые паттерны

### Command Pattern
- `Command` - абстрактный базовый класс
- `PrintCommand`, `VolumeUpCommand`, `VolumeDownCommand`, `MediaPlayerCommand` - конкретные команды
- `Keyboard` - receiver, который выполняет команды

### Memento Pattern
- `KeyboardStateSaver` - caretaker, отвечает за сохранение/восстановление состояния
- JSON файл - memento, хранит состояние привязок клавиш

### Factory Pattern
- `CommandFactory` - создает команды по типу и параметрам

## Файлы результатов

После запуска программы создаются:
- `keyboard_state.json` - файл с сохраненными привязками клавиш
- `output.txt` - файл с результатами выполнения команд

## Особенности реализации

1. **Простой JSON парсер** - для учебных целей реализован простой парсер JSON без внешних библиотек
2. **Умные указатели** - используется `std::shared_ptr` для автоматического управления памятью
3. **STL контейнеры** - `std::map`, `std::vector` для хранения данных
4. **Обработка ошибок** - проверка открытия файлов и валидности данных


┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│     main()      │ ──▶│   Keyboard       │──▶│   Commands      │
│                 │    │   (Receiver)     │    │   (Print, Vol)  │
└─────────────────┘    └──────────────────┘    └─────────────────┘
         │                       │                       │
         ▼                       ▼                       ▼
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│ CommandFactory  │    │ KeyboardStateSaver│    │   Command      │
│   (Factory)     │    │   (Memento)      │    │  (Interface)    │
└─────────────────┘    └──────────────────┘    └─────────────────┘

🔍 Ключевые вопросы для понимания
При чтении каждого файла задавайтесь вопросами:
Command.h: "Что должна уметь делать любая команда?"
Commands.h: "Какие конкретные действия можно выполнить?"
Keyboard.h: "Как клавиатура хранит и выполняет команды?"
CommandFactory: "Как создавать команды по типу?"
KeyboardStateSaver: "Как сохранить и восстановить состояние?"
💡 Советы для лучшего понимания
Запустите программу и посмотрите на вывод
Измените что-то в коде и посмотрите, что изменится
Добавьте новую команду - это поможет понять паттерн
Проследите выполнение одной команды от начала до конца
🚀 Практическое задание
Попробуйте добавить новую команду ClearCommand, которая очищает весь текст. Это поможет вам понять весь процесс:
Добавьте класс в Commands.h
Реализуйте в Commands.cpp
Зарегистрируйте в main.cpp
Привяжите к клавише
Хотите, чтобы я показал, как это сделать?